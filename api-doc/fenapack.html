<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>fenapack package &mdash; FEnaPack 1.7.0dev documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.7.0dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="FEnaPack 1.7.0dev documentation" href="../index.html" />
    <link rel="prev" title="PCD preconditioner for Navier-Stokes equations" href="../demos/navier-stokes-pcd.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../demos/navier-stokes-pcd.html" title="PCD preconditioner for Navier-Stokes equations"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">FEnaPack 1.7.0dev documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-fenapack">
<span id="fenapack-package"></span><h1>fenapack package<a class="headerlink" href="#module-fenapack" title="Permalink to this headline">¶</a></h1>
<p>This is FENaPack, FEniCS Navier-Stokes preconditioning package.</p>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-fenapack.field_split">
<span id="fenapack-field-split-module"></span><h2>fenapack.field_split module<a class="headerlink" href="#module-fenapack.field_split" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="fenapack.field_split.FieldSplitSolver">
<em class="property">class </em><code class="descclassname">fenapack.field_split.</code><code class="descname">FieldSplitSolver</code><span class="sig-paren">(</span><em>space</em>, <em>method</em>, <em>options_prefix=''</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fenapack/field_split.html#FieldSplitSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.field_split.FieldSplitSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dolfin.cpp.la.PETScKrylovSolver</span></code></p>
<p>This class derives from <code class="xref py py-class docutils literal"><span class="pre">dolfin.PETScKrylovSolver</span></code> and
implements field split preconditioner for saddle point problems like
incompressible (Navier-)Stokes flow.</p>
<dl class="method">
<dt id="fenapack.field_split.FieldSplitSolver.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>space</em>, <em>method</em>, <em>options_prefix=''</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fenapack/field_split.html#FieldSplitSolver.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.field_split.FieldSplitSolver.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create field split solver on a given space for a particular method.</p>
<dl class="docutils">
<dt><em>Arguments</em></dt>
<dd><dl class="first last docutils">
<dt>space (<code class="xref py py-class docutils literal"><span class="pre">dolfin.FunctionSpace</span></code>)</dt>
<dd>Mixed function space determining the field split.</dd>
<dt>method (<code class="xref py py-class docutils literal"><span class="pre">string</span></code>)</dt>
<dd>Type of a PETSc KSP object, see
help(<code class="xref py py-class docutils literal"><span class="pre">petsc4py.PETSc.KSP.Type</span></code>).</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="staticmethod">
<dt id="fenapack.field_split.FieldSplitSolver.default_parameters">
<em class="property">static </em><code class="descname">default_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fenapack/field_split.html#FieldSplitSolver.default_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.field_split.FieldSplitSolver.default_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Extend default parameter set of parent class.</p>
</dd></dl>

<dl class="method">
<dt id="fenapack.field_split.FieldSplitSolver.get_subopts">
<code class="descname">get_subopts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fenapack/field_split.html#FieldSplitSolver.get_subopts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.field_split.FieldSplitSolver.get_subopts" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="xref py py-class docutils literal"><span class="pre">petsc4py.PETSc.Options</span></code> databases of 00 and 11
subKSP.</p>
</dd></dl>

<dl class="method">
<dt id="fenapack.field_split.FieldSplitSolver.set_operators">
<code class="descname">set_operators</code><span class="sig-paren">(</span><em>A</em>, <em>P</em>, <em>**schur_approx</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fenapack/field_split.html#FieldSplitSolver.set_operators"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.field_split.FieldSplitSolver.set_operators" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">A</span></code> and <code class="docutils literal"><span class="pre">P</span></code> represents a system matrix operator and
a preconditioner in the usual sense.</p>
<p><strong>Overloaded versions</strong></p>
<blockquote>
<div>Optional keyword arguments in <code class="docutils literal"><span class="pre">schur_approx</span></code> can be used to build
an approximate Schur complement matrix. These optional arguments
differ depending on the strategy used for preconditioning. See
classes in <a class="reference internal" href="#module-fenapack.preconditioners" title="fenapack.preconditioners"><code class="xref py py-class docutils literal"><span class="pre">fenapack.preconditioners</span></code></a> module.</div></blockquote>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fenapack.nonlinear_solvers">
<span id="fenapack-nonlinear-solvers-module"></span><h2>fenapack.nonlinear_solvers module<a class="headerlink" href="#module-fenapack.nonlinear_solvers" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="fenapack.nonlinear_solvers.NewtonSolver">
<em class="property">class </em><code class="descclassname">fenapack.nonlinear_solvers.</code><code class="descname">NewtonSolver</code><span class="sig-paren">(</span><em>solver</em>, <em>debug_hook=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fenapack/nonlinear_solvers.html#NewtonSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.nonlinear_solvers.NewtonSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dolfin.cpp.la.NewtonSolver</span></code></p>
<p>This class is a modification of <code class="xref py py-class docutils literal"><span class="pre">dolfin.NewtonSolver</span></code>
suitable to deal appropriately with
<a class="reference internal" href="#fenapack.field_split.FieldSplitSolver" title="fenapack.field_split.FieldSplitSolver"><code class="xref py py-class docutils literal"><span class="pre">fenapack.field_split.FieldSplitSolver</span></code></a> and PCD
preconditioners from <a class="reference internal" href="#module-fenapack.preconditioners" title="fenapack.preconditioners"><code class="xref py py-class docutils literal"><span class="pre">fenapack.preconditioners</span></code></a> module.
In particular, it takes properly of linear solver and preconditioner
setup in between succesive Newton iterations.</p>
<dl class="method">
<dt id="fenapack.nonlinear_solvers.NewtonSolver.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>solver</em>, <em>debug_hook=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fenapack/nonlinear_solvers.html#NewtonSolver.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.nonlinear_solvers.NewtonSolver.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create Newton solver for solver for given problem. Optional
debug hook executed on every iteration can be provided.</p>
<dl class="docutils">
<dt><em>Arguments</em></dt>
<dd><dl class="first last docutils">
<dt>solver (<code class="xref py py-class docutils literal"><span class="pre">GenericLinearSolver</span></code>)</dt>
<dd>A linear solver.</dd>
<dt>debug_hook (function)</dt>
<dd><p class="first">A function of the signature:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="nb">bool</span> <span class="n">dolfin</span><span class="o">.</span><span class="n">NewtonSolver</span><span class="o">.</span><span class="n">converged</span><span class="p">(</span><span class="n">GenericVector</span> <span class="n">r</span><span class="p">,</span> <span class="n">NonlinearProblem</span> <span class="n">problem</span><span class="p">,</span> <span class="nb">int</span> <span class="n">iteration</span><span class="p">)</span>
</pre></div>
</div>
<p class="last">Provided <code class="docutils literal"><span class="pre">r</span></code> is a current residual vector, <code class="docutils literal"><span class="pre">problem</span></code> is
argument supplied to <code class="docutils literal"><span class="pre">solve</span></code> and <code class="docutils literal"><span class="pre">iteration</span></code> is number of
current iteration; <code class="xref py py-class docutils literal"><span class="pre">bool</span></code> return value is ignored.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="fenapack.nonlinear_solvers.NewtonSolver.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><em>problem</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fenapack/nonlinear_solvers.html#NewtonSolver.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.nonlinear_solvers.NewtonSolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve abstract nonlinear problem <span class="math">\(F(x) = 0\)</span> for given
<span class="math">\(F\)</span> and Jacobian <span class="math">\(\dfrac{\partial F}{\partial x}\)</span>.</p>
<dl class="docutils">
<dt><em>Arguments</em></dt>
<dd><dl class="first last docutils">
<dt>problem (<code class="xref py py-class docutils literal"><span class="pre">dolfin.NonlinearProblem</span></code>)</dt>
<dd>The nonlinear problem.</dd>
<dt>x (<code class="xref py py-class docutils literal"><span class="pre">dolfin.GenericVector</span></code>)</dt>
<dd>The unknown vector.</dd>
</dl>
</dd>
<dt><em>Returns</em></dt>
<dd><dl class="first last docutils">
<dt>(int, bool)</dt>
<dd>Pair of number of Newton iterations, and whether
iteration converged)</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fenapack.nonlinear_solvers.PCDProblem">
<em class="property">class </em><code class="descclassname">fenapack.nonlinear_solvers.</code><code class="descname">PCDProblem</code><span class="sig-paren">(</span><em>F</em>, <em>bcs</em>, <em>J</em>, <em>J_pc=None</em>, <em>mp=None</em>, <em>mu=None</em>, <em>ap=None</em>, <em>fp=None</em>, <em>kp=None</em>, <em>bcs_pcd=[]</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fenapack/nonlinear_solvers.html#PCDProblem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.nonlinear_solvers.PCDProblem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dolfin.cpp.la.NonlinearProblem</span></code></p>
<p>Class for interfacing with <a class="reference internal" href="#fenapack.nonlinear_solvers.NewtonSolver" title="fenapack.nonlinear_solvers.NewtonSolver"><code class="xref py py-class docutils literal"><span class="pre">NewtonSolver</span></code></a>.</p>
<dl class="method">
<dt id="fenapack.nonlinear_solvers.PCDProblem.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>F</em>, <em>bcs</em>, <em>J</em>, <em>J_pc=None</em>, <em>mp=None</em>, <em>mu=None</em>, <em>ap=None</em>, <em>fp=None</em>, <em>kp=None</em>, <em>bcs_pcd=[]</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fenapack/nonlinear_solvers.html#PCDProblem.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.nonlinear_solvers.PCDProblem.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return subclass of <code class="xref py py-class docutils literal"><span class="pre">dolfin.NonlinearProblem</span></code> suitable
for <a class="reference internal" href="#fenapack.nonlinear_solvers.NewtonSolver" title="fenapack.nonlinear_solvers.NewtonSolver"><code class="xref py py-class docutils literal"><span class="pre">NewtonSolver</span></code></a> based on
<a class="reference internal" href="#fenapack.field_split.FieldSplitSolver" title="fenapack.field_split.FieldSplitSolver"><code class="xref py py-class docutils literal"><span class="pre">fenapack.field_split.FieldSplitSolver</span></code></a> and PCD
preconditioners from <a class="reference internal" href="#module-fenapack.field_split" title="fenapack.field_split"><code class="xref py py-class docutils literal"><span class="pre">fenapack.field_split</span></code></a>.</p>
<dl class="docutils">
<dt><em>Arguments</em></dt>
<dd><dl class="first last docutils">
<dt>F (<code class="xref py py-class docutils literal"><span class="pre">dolfin.Form</span></code> or <code class="xref py py-class docutils literal"><span class="pre">ufl.Form</span></code>)</dt>
<dd>Linear form representing the equation.</dd>
<dt>bcs (<code class="xref py py-class docutils literal"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal"><span class="pre">dolfin.DirichletBC</span></code>)</dt>
<dd>Boundary conditions applied to <code class="docutils literal"><span class="pre">F</span></code>, <code class="docutils literal"><span class="pre">J</span></code>, and <code class="docutils literal"><span class="pre">J_pc</span></code>.</dd>
<dt>J (<code class="xref py py-class docutils literal"><span class="pre">dolfin.Form</span></code> or <code class="xref py py-class docutils literal"><span class="pre">ufl.Form</span></code>)</dt>
<dd>Bilinear form representing system Jacobian.</dd>
<dt>J_pc (<code class="xref py py-class docutils literal"><span class="pre">dolfin.Form</span></code> or <code class="xref py py-class docutils literal"><span class="pre">ufl.Form</span></code>)</dt>
<dd>Bilinear form representing Jacobian optionally passed to
preconditioner instead of <code class="docutils literal"><span class="pre">J</span></code>. In case of PCD, stabilized
00-block can be passed to 00-KSP solver.</dd>
<dt>mp, mu, ap, fp, kp (<code class="xref py py-class docutils literal"><span class="pre">dolfin.Form</span></code> or <code class="xref py py-class docutils literal"><span class="pre">ufl.Form</span></code>)</dt>
<dd><p class="first">Bilinear forms which (some of them) might be used by a
particular PCD preconditioner. Typically they represent &#8220;mass
matrix&#8221; on pressure, &#8220;mass matrix&#8221; on velocity, minus Laplacian
operator on pressure, pressure convection-diffusion operator,
and pressure convection operator respectively.</p>
<p class="last"><code class="docutils literal"><span class="pre">mp</span></code>, <code class="docutils literal"><span class="pre">mu</span></code>, and <code class="docutils literal"><span class="pre">ap</span></code> are assumed to be constant during
subsequent non-linear iterations and are assembled only once.
On the other hand, <code class="docutils literal"><span class="pre">fp</span></code> and <code class="docutils literal"><span class="pre">kp</span></code> are updated in every
iteration.</p>
</dd>
<dt>bcs_pcd (<code class="xref py py-class docutils literal"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal"><span class="pre">dolfin.DirichletBC</span></code>)</dt>
<dd>Artificial boundary conditions used by PCD preconditioner.</dd>
</dl>
</dd>
</dl>
<p>All the arguments should be given on the common mixed function space.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fenapack.preconditioners">
<span id="fenapack-preconditioners-module"></span><h2>fenapack.preconditioners module<a class="headerlink" href="#module-fenapack.preconditioners" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="fenapack.preconditioners.PCDPC_SEW">
<em class="property">class </em><code class="descclassname">fenapack.preconditioners.</code><code class="descname">PCDPC_SEW</code><a class="reference internal" href="../_modules/fenapack/preconditioners.html#PCDPC_SEW"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.preconditioners.PCDPC_SEW" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">fenapack.preconditioners.BasePCDPC</span></code></p>
<p>This class implements steady variant of PCD described in <a class="footnote-reference" href="#id2" id="id1">[1]</a>.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id3">2</a>)</em> Elman H. C., Silvester D. J., Wathen A. J., <em>Finite Elements and Fast
Iterative Solvers: With Application in Incompressible Fluid Dynamics</em>.
Oxford University Press 2005. 2nd edition 2014.</td></tr>
</tbody>
</table>
<dl class="method">
<dt id="fenapack.preconditioners.PCDPC_SEW.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>pc</em>, <em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fenapack/preconditioners.html#PCDPC_SEW.apply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.preconditioners.PCDPC_SEW.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>This method implements the action of the inverse of the approximate
Schur complement <span class="math">\(\hat{S} = -M_p F_p^{-1} A_p\)</span>, that is</p>
<div class="math">
\[y = \hat{S}^{-1} x = -A_p^{-1} F_p M_p^{-1} x.\]</div>
</dd></dl>

<dl class="method">
<dt id="fenapack.preconditioners.PCDPC_SEW.set_operators">
<code class="descname">set_operators</code><span class="sig-paren">(</span><em>is0</em>, <em>is1</em>, <em>A</em>, <em>P</em>, <em>Mp=None</em>, <em>Ap=None</em>, <em>Fp=None</em>, <em>bcs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fenapack/preconditioners.html#PCDPC_SEW.set_operators"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.preconditioners.PCDPC_SEW.set_operators" title="Permalink to this definition">¶</a></dt>
<dd><p>Set operators for the approximate Schur complement matrix</p>
<dl class="docutils">
<dt><em>Arguments</em></dt>
<dd><dl class="first last docutils">
<dt>is0, is1 (<code class="xref py py-class docutils literal"><span class="pre">petsc4py.PETSc.IS</span></code>)</dt>
<dd>The index sets defining blocks in the field-splitted matrix.</dd>
<dt>A (<code class="xref py py-class docutils literal"><span class="pre">GenericMatrix</span></code>)</dt>
<dd>Dummy system matrix. Not used by this implementation.</dd>
<dt>P (<code class="xref py py-class docutils literal"><span class="pre">GenericMatrix</span></code>)</dt>
<dd>Dummy preconditioning matrix. Not used by this implementation.</dd>
</dl>
</dd>
<dt><em>Keyword arguments</em></dt>
<dd><dl class="first last docutils">
<dt>Mp (<code class="xref py py-class docutils literal"><span class="pre">GenericMatrix</span></code>)</dt>
<dd>The matrix containing pressure mass matrix as its 11-block.</dd>
<dt>Ap (<code class="xref py py-class docutils literal"><span class="pre">GenericMatrix</span></code>)</dt>
<dd>The matrix containing pressure laplacian as its 11-block.</dd>
<dt>Fp (<code class="xref py py-class docutils literal"><span class="pre">GenericMatrix</span></code>)</dt>
<dd>The matrix containing pressure convection-diffusion as its
11-block.</dd>
<dt>bcs (<code class="xref py py-class docutils literal"><span class="pre">DirichletBC</span></code>)</dt>
<dd>List of boundary conditions that will be &#8220;applied&#8221; on
<span class="math">\(A_p\)</span> and <span class="math">\(F_p\)</span>.</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fenapack.preconditioners.UnsteadyPCDPC_SEW">
<em class="property">class </em><code class="descclassname">fenapack.preconditioners.</code><code class="descname">UnsteadyPCDPC_SEW</code><a class="reference internal" href="../_modules/fenapack/preconditioners.html#UnsteadyPCDPC_SEW"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.preconditioners.UnsteadyPCDPC_SEW" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fenapack.preconditioners.PCDPC_SEW" title="fenapack.preconditioners.PCDPC_SEW"><code class="xref py py-class docutils literal"><span class="pre">fenapack.preconditioners.PCDPC_SEW</span></code></a></p>
<p>This class implements variant of PCD described in <a class="footnote-reference" href="#id2" id="id3">[1]</a> appropriate for
unsteady problems. It derives from <a class="reference internal" href="#fenapack.preconditioners.PCDPC_SEW" title="fenapack.preconditioners.PCDPC_SEW"><code class="xref py py-class docutils literal"><span class="pre">PCDPC_SEW</span></code></a> but pressure Laplacian
<span class="math">\(A_p\)</span> is approximated by <span class="math">\(B (\operatorname{diag} M_u)^{-1}
B^\top\)</span>, where <span class="math">\(M_u\)</span> is the velocity mass matrix, <span class="math">\(B\)</span>
corresponds to 10-block of the system matrix (<span class="math">\(\operatorname{div}\)</span>
operator) and <span class="math">\(B^\top\)</span> is its transpose, i.e. 01-block of the system
matrix (<span class="math">\(\operatorname{grad}\)</span> operator).</p>
<p>Note that <span class="math">\(B^\top\)</span> contains zero rows corresponding to dofs on the
Dirichlet boundary since bcs have been applied on <span class="math">\(A\)</span>. Moreover,
<span class="math">\(B (\operatorname{diag} M_u)^{-1} B^\top\)</span> is nonsingular for
inflow-outflow problems, thus we do not need to prescribe any artificial
boundary conditions for pressure.</p>
<dl class="method">
<dt id="fenapack.preconditioners.UnsteadyPCDPC_SEW.set_operators">
<code class="descname">set_operators</code><span class="sig-paren">(</span><em>is0</em>, <em>is1</em>, <em>A</em>, <em>P</em>, <em>Mp=None</em>, <em>Mu=None</em>, <em>Fp=None</em>, <em>bcs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fenapack/preconditioners.html#UnsteadyPCDPC_SEW.set_operators"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.preconditioners.UnsteadyPCDPC_SEW.set_operators" title="Permalink to this definition">¶</a></dt>
<dd><p>Set operators for the approximate Schur complement matrix</p>
<dl class="docutils">
<dt><em>Arguments</em></dt>
<dd><dl class="first last docutils">
<dt>is0, is1 (<code class="xref py py-class docutils literal"><span class="pre">petsc4py.PETSc.IS</span></code>)</dt>
<dd>The index sets defining blocks in the field splitted matrix.</dd>
<dt>A (<code class="xref py py-class docutils literal"><span class="pre">GenericMatrix</span></code>)</dt>
<dd>The system matrix.</dd>
<dt>P (<code class="xref py py-class docutils literal"><span class="pre">GenericMatrix</span></code>)</dt>
<dd>Dummy preconditioning matrix. Not used by this implementation.</dd>
</dl>
</dd>
<dt><em>Keyword arguments</em></dt>
<dd><dl class="first last docutils">
<dt>Mp (<code class="xref py py-class docutils literal"><span class="pre">GenericMatrix</span></code>)</dt>
<dd>The matrix containing pressure mass matrix as its 11-block.</dd>
<dt>Mu (<code class="xref py py-class docutils literal"><span class="pre">GenericMatrix</span></code>)</dt>
<dd>The matrix containing velocity mass matrix as its 00-block.</dd>
<dt>Fp (<code class="xref py py-class docutils literal"><span class="pre">GenericMatrix</span></code>)</dt>
<dd>The matrix containing pressure convection-diffusion as its
11-block.</dd>
<dt>bcs (<code class="xref py py-class docutils literal"><span class="pre">DirichletBC</span></code>)</dt>
<dd>List of boundary conditions that will be &#8220;applied&#8221; on
<span class="math">\(F_p\)</span>.</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fenapack.preconditioners.PCDPC_BRM">
<em class="property">class </em><code class="descclassname">fenapack.preconditioners.</code><code class="descname">PCDPC_BRM</code><a class="reference internal" href="../_modules/fenapack/preconditioners.html#PCDPC_BRM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.preconditioners.PCDPC_BRM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">fenapack.preconditioners.BasePCDPC</span></code></p>
<p>This class implements a modification of PCD variant similar to one by
<a class="footnote-reference" href="#id5" id="id4">[2]</a>.</p>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[2]</a></td><td>Olshanskii M. A., Vassilevski Y. V., <em>Pressure Schur complement
preconditioners for the discrete Oseen problem</em>.
SIAM J. Sci. Comput., 29(6), 2686-2704. 2007.</td></tr>
</tbody>
</table>
<dl class="method">
<dt id="fenapack.preconditioners.PCDPC_BRM.apply">
<code class="descname">apply</code><span class="sig-paren">(</span><em>pc</em>, <em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fenapack/preconditioners.html#PCDPC_BRM.apply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.preconditioners.PCDPC_BRM.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>This method implements the action of the inverse of the approximate
Schur complement <span class="math">\(-\hat{S}^{-1}\)</span>, that is</p>
<div class="math">
\[y = -M_p^{-1} (I + K_p A_p^{-1}) x\]</div>
<p>where <span class="math">\(K_p\)</span> is used to denote pressure convection matrix plus
possibly pressure mass matrix coming from discrete time derivative.
Note that Laplace solve with <span class="math">\(A_p^{-1} x\)</span> is performed with usual
non-symmetric application of subfield BC on matrix <span class="math">\(A_p\)</span> and RHS
<span class="math">\(x\)</span> (but only in that term). It is crucial that identity term
<span class="math">\(I x\)</span> is not absorbed into the second, compact term to get</p>
<div class="math">
\[y = -M_p^{-1} (A_p + K_p) A_p^{-1} x.\]</div>
<p>This is crucial to keep a stability with respect to the leading Stokes
term.</p>
<p>Good strategy is to use <span class="math">\(M_p\)</span> and <span class="math">\(K_p\)</span> both scaled by
<span class="math">\(\nu^{-1}\)</span>.</p>
</dd></dl>

<dl class="method">
<dt id="fenapack.preconditioners.PCDPC_BRM.set_operators">
<code class="descname">set_operators</code><span class="sig-paren">(</span><em>is0</em>, <em>is1</em>, <em>A</em>, <em>P</em>, <em>Mp=None</em>, <em>Ap=None</em>, <em>Kp=None</em>, <em>bcs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fenapack/preconditioners.html#PCDPC_BRM.set_operators"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.preconditioners.PCDPC_BRM.set_operators" title="Permalink to this definition">¶</a></dt>
<dd><p>Set operators for the approximate Schur complement matrix</p>
<dl class="docutils">
<dt><em>Arguments</em></dt>
<dd><dl class="first last docutils">
<dt>is0, is1 (<code class="xref py py-class docutils literal"><span class="pre">petsc4py.PETSc.IS</span></code>)</dt>
<dd>The index sets defining blocks in the field splitted matrix.</dd>
<dt>A (<code class="xref py py-class docutils literal"><span class="pre">GenericMatrix</span></code>)</dt>
<dd>Dummy system matrix. Not used by this implementation.</dd>
<dt>P (<code class="xref py py-class docutils literal"><span class="pre">GenericMatrix</span></code>)</dt>
<dd>Dummy preconditioning matrix. Not used by this implementation.</dd>
</dl>
</dd>
<dt><em>Keyword arguments</em></dt>
<dd><dl class="first last docutils">
<dt>Mp (<code class="xref py py-class docutils literal"><span class="pre">GenericMatrix</span></code>)</dt>
<dd>The matrix containing pressure mass matrix as its 11-block.</dd>
<dt>Ap (<code class="xref py py-class docutils literal"><span class="pre">GenericMatrix</span></code>)</dt>
<dd>The matrix containing pressure laplacian as its 11-block.</dd>
<dt>Kp (<code class="xref py py-class docutils literal"><span class="pre">GenericMatrix</span></code>)</dt>
<dd>The matrix containing pressure convection plus possibly mass
matrix comming from the time derivative as its 11-block.</dd>
<dt>bcs (<code class="xref py py-class docutils literal"><span class="pre">DirichletBC</span></code>)</dt>
<dd>List of boundary conditions that will be applied during
<span class="math">\(A_p^{-1} x\)</span> solve.</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fenapack.stabilization">
<span id="fenapack-stabilization-module"></span><h2>fenapack.stabilization module<a class="headerlink" href="#module-fenapack.stabilization" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="fenapack.stabilization.StabilizationParameterSD">
<code class="descclassname">fenapack.stabilization.</code><code class="descname">StabilizationParameterSD</code><span class="sig-paren">(</span><em>wind</em>, <em>viscosity</em>, <em>density=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fenapack/stabilization.html#StabilizationParameterSD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fenapack.stabilization.StabilizationParameterSD" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a subclass of <code class="xref py py-class docutils literal"><span class="pre">dolfin.Expression</span></code> representing
streamline diffusion stabilization parameter.</p>
<p>This kind of stabilization is convenient when a multigrid method is used
for the convection term in the Navier-Stokes equation. The idea of the
stabilization involves adding an additional term of the form:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">delta_sd</span><span class="o">*</span><span class="n">inner</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">w</span><span class="p">),</span> <span class="n">dot</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">w</span><span class="p">))</span><span class="o">*</span><span class="n">dx</span>
</pre></div>
</div>
<p>into the Navier-Stokes equation. Here <code class="docutils literal"><span class="pre">u</span></code> is a trial function, <code class="docutils literal"><span class="pre">v</span></code> is a
test function and <code class="docutils literal"><span class="pre">w</span></code> defines so-called &#8220;wind&#8221; which is a known vector
function.  Regularization parameter <code class="docutils literal"><span class="pre">delta_sd</span></code> is determined by the local
mesh Peclet number (PE), see the implementation below.</p>
<dl class="docutils">
<dt><em>Arguments</em></dt>
<dd><dl class="first last docutils">
<dt>wind (<code class="xref py py-class docutils literal"><span class="pre">dolfin.GenericFunction</span></code>)</dt>
<dd>A vector field determining convective velocity.</dd>
<dt>viscosity (<code class="xref py py-class docutils literal"><span class="pre">dolfin.GenericFunction</span></code>)</dt>
<dd>A scalar field determining dynamic viscosity.</dd>
<dt>density (<code class="xref py py-class docutils literal"><span class="pre">dolfin.GenericFunction</span></code>)</dt>
<dd>A scalar field determining density (optional).</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">fenapack package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-fenapack.field_split">fenapack.field_split module</a></li>
<li><a class="reference internal" href="#module-fenapack.nonlinear_solvers">fenapack.nonlinear_solvers module</a></li>
<li><a class="reference internal" href="#module-fenapack.preconditioners">fenapack.preconditioners module</a></li>
<li><a class="reference internal" href="#module-fenapack.stabilization">fenapack.stabilization module</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../demos/navier-stokes-pcd.html"
                        title="previous chapter">PCD preconditioner for Navier-Stokes equations</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/api-doc/fenapack.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../demos/navier-stokes-pcd.html" title="PCD preconditioner for Navier-Stokes equations"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">FEnaPack 1.7.0dev documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Jan Blechta, Martin Řehoř.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
  </body>
</html>